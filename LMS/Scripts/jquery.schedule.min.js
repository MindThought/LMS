/** jQuery Schedule v1.0.1 | https://github.com/Yehzuna/jquery-schedule */
!function(t,i,e,o){"use strict";function r(i,e){this.element=i,this.settings=t.extend({},n,e),this._defaults=n,this._name=s,this.init()}var s="jqs",n={mode:"edit",hour:24,data:[],days:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],invalidPeriod:"Invalid period.",invalidPosition:"Invalid position.",removePeriod:"Remove this period ?"};t.extend(r.prototype,{init:function(){var i=this;t(this.element).addClass("jqs"),"edit"===this.settings.mode&&t(this.element).on("click",".jqs-wrapper",function(e){if(t(e.target).hasClass("jqs-period")||t(e.target).parents(".jqs-period").length>0)return!1;var o=Math.round(e.offsetY/20);o>=48&&(o=47),i.add(t(this),"id_"+e.timeStamp,o)}).on("click",".jqs-remove",function(){confirm(i.settings.removePeriod)&&t(this).parents(".jqs-period").remove()}),this.create(),this.generate()},create:function(){t('<table class="jqs-table"><tr></tr></table>').appendTo(t(this.element));for(var i=0;i<7;i++)t('<td><div class="jqs-wrapper"></div></td>').appendTo(t(".jqs-table tr",this.element));t('<div class="jqs-grid"><div class="jqs-grid-head"></div></div>').appendTo(t(this.element));for(var e=0;e<25;e++)t('<div class="jqs-grid-line"><span>'+this.formatHour(e)+"</span></div>").appendTo(t(".jqs-grid",this.element));for(var o=0;o<7;o++)t('<div class="jqs-grid-day">'+this.settings.days[o]+"</div>").appendTo(t(".jqs-grid-head",this.element))},generate:function(){if(this.settings.data.length>0){var i=this;t.each(this.settings.data,function(e,o){t.each(o.periods,function(e,r){var s=t(".jqs-wrapper",i.element).eq(o.day),n=i.positionFormat(r[0]),a=i.positionFormat(r[1]);if(0===a&&(a=48),n<=a){var d="id_"+e+o.day+n+a;i.add(s,d,n,a-n)}else console.error(i.settings.invalidPeriod,i.periodInit(n,n+(a-n)))})})}},add:function(i,e,o,r){r||(r=1);var s="";"edit"===this.settings.mode&&(s='<div class="jqs-remove"></div>');var n=this.periodInit(o,o+r),a=t('<div class="jqs-period"><div class="jqs-period-placeholder">'+s+"<span>"+n+"</span></div></div>").css({top:20*o,height:20*r}).attr("id",e).appendTo(i);if(!this.isValid(a))return console.error(this.settings.invalidPeriod,n),t(a).remove(),!1;if("edit"===this.settings.mode){var d=this;a.draggable({grid:[0,20],containment:"parent",drag:function(i,e){t("span",e.helper).text(d.periodDrag(e))},stop:function(i,e){d.isValid(t(e.helper))||(console.error(d.settings.invalidPosition),t(e.helper).css("top",Math.round(e.originalPosition.top)))}}).resizable({grid:[0,20],containment:"parent",handles:"n, s",resize:function(i,e){t("span",e.helper).text(d.periodResize(e))},stop:function(i,e){d.isValid(t(e.helper))||(console.error(d.settings.invalidPosition),t(e.helper).css({height:Math.round(e.originalSize.height),top:Math.round(e.originalPosition.top)}))}})}},periodInit:function(t,i){return this.periodFormat(t)+" - "+this.periodFormat(i)},periodDrag:function(i){var e=Math.round(i.position.top/20),o=Math.round((t(i.helper).height()+i.position.top)/20);return this.periodFormat(e)+" - "+this.periodFormat(o)},periodResize:function(t){var i=Math.round(t.position.top/20),e=Math.round((t.size.height+t.position.top)/20);return this.periodFormat(i)+" - "+this.periodFormat(e)},periodData:function(t){var i=Math.round(t.position().top/20),e=Math.round((t.height()+t.position().top)/20);return[this.periodFormat(i),this.periodFormat(e)]},periodFormat:function(t){var i=0;if(12===this.settings.hour){var e=Math.floor(t/2),o=":30";t%2==0&&(o=""),i=e+o+"am",e>12&&(i=e-12+o+"pm"),0!==e&&24!==e||(i=12+o+"am"),12===e&&(i=12+o+"pm")}else t>=48&&(t=0),(i=Math.floor(t/2))<10&&(i="0"+i),i+=t%2==0?":00":":30";return i},positionFormat:function(t){var i=0;if(12===this.settings.hour){var e=t.match(/([0-1]?[0-9]):?([0-5][0-9])?\s?(am|pm)/),o=parseInt(e[1]),r=parseInt(e[2]),s=e[3];12===o&&"am"===s&&(o=0),12===o&&"pm"===s&&(s="am"),"pm"===s&&(o+=12),i=2*o,30===r&&i++}else{var n=t.split(":");i=2*parseInt(n[0]),30===parseInt(n[1])&&i++}return i},formatHour:function(t){if(12===this.settings.hour)switch(t){case 0:case 24:t="12 am";break;case 12:t="12 pm";break;default:t>12?t=t-12+" pm":t+=" am"}else t>=24&&(t=0),t<10&&(t="0"+t),t+=":00";return t},isValid:function(i){var e=Math.round(i.position().top),o=Math.round(i.position().top+i.height()),r=0,s=0,n=!0;return t(".jqs-period",t(i).parent()).each(function(a,d){d=t(d),i.attr("id")!==d.attr("id")&&(r=Math.round(d.position().top),s=Math.round(d.position().top+d.height()),r>e&&r<o&&(n=!1),s>e&&s<o&&(n=!1),r<e&&s>o&&(n=!1),r!==e&&s!==o||(n=!1))}),n},export:function(){var i=this,e=[];return t(".jqs-wrapper",i.element).each(function(o,r){var s={day:o,periods:[]};t(".jqs-period",r).each(function(e,o){s.periods.push(i.periodData(t(o)))}),e.push(s)}),JSON.stringify(e)}}),t.fn[s]=function(i){var e=!1,o=this.each(function(){t.data(this,"plugin_"+s)?t.isFunction(r.prototype[i])&&(e=t.data(this,"plugin_"+s)[i]()):t.data(this,"plugin_"+s,new r(this,i))});return e||o}}(jQuery,window,document);